<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>ตารางการใช้ห้อง ม.แม่โจ้</title>
<link href="https://fonts.googleapis.com/css2?family=Prompt&display=swap" rel="stylesheet">

<style>
:root{
  --primary:#1B5006;
  --secondary:#4FB477;
  --bg:#FFFFFF;
  --text:#1E152A;
  --accent:#3A2E39;
}

/* reset */
*{box-sizing:border-box;margin:0;padding:0;}

body {
  font-family:'Prompt',sans-serif;
  background:var(--bg);
  color:var(--text);
  padding:1rem;
}
.header {text-align:center;margin-bottom:1rem;}
.filters {
  display:flex;flex-wrap:wrap;
  gap:0.5rem;
  justify-content:center;
  margin-bottom:1rem;
}
.filters select, .filters button{
  padding:.6rem;
  font-size:1rem;
  border:1px solid var(--accent);
  background:var(--secondary);
  color:#fff;
  border-radius:4px;
}
.filters button:hover{
  background:var(--primary);
  cursor:pointer;
}

/* container ของตาราง */
.table-container {
  overflow-x:auto;
  scroll-snap-type:x mandatory;
}

/* ตาราง desktop */
table {
  width:100%;
  border-collapse:collapse;
  min-width:600px;
}
th,td {
  border:1px solid var(--accent);
  padding:.5rem;
  text-align:center;
  font-size:.9rem;
}
th {
  background:var(--primary);
  color:#fff;
}

/* ทำ card layout เมื่อหน้าจอแคบ */
@media (max-width:600px){
  table, thead, tbody, th, td, tr {
    display:block;
  }
  thead tr {
    position:absolute;
    top:-9999px; left:-9999px;
  }
  tr {
    margin:0 0 1rem 0;
    border:1px solid var(--accent);
    border-radius:6px;
    padding:0.5rem;
    scroll-snap-align:start;
  }
  td {
    border:none;
    border-bottom:1px solid var(--accent);
    position:relative;
    padding-left:50%;
    text-align:left;
  }
  td:before {
    position:absolute;
    top:50%;left:.5rem;
    transform:translateY(-50%);
    width:45%;
    white-space:nowrap;
    font-weight:bold;
  }
  /* เพิ่ม label ก่อนข้อมูล - ใช้ attr(data-label) */
  td[data-label]:before {
    content:attr(data-label);
  }
}
</style>
</head>
<body>

<div class="header">
  <h2>ตารางการใช้ห้อง มหาวิทยาลัยแม่โจ้</h2>
</div>

<div class="filters">
  <select id="roomSelect"><option value="">-- เลือกอาคาร --</option></select>
  <button id="loadBtn">ดูตาราง</button>
</div>

<div class="table-container" id="tableContainer"></div>

<script>
const buildings = [
  {code:"101",name:"อาคารพัฒนาวิศัยทัศน์"},
  {code:"102",name:"ประเสริฐ ณ นคร"},
  {code:"103",name:"สมิตตานนท์"},
  {code:"104",name:"คณะวิศวกรรมและอุตสาหกรรมเกษตร"}
];

const mockData = {
  "101": {
    rooms:["101"],
    timeslots:["08:00-09:00","09:00-10:00","10:00-11:00"],
    entries:[
      {timeslot:"08:00-09:00",room:"101",subject:"โครงสร้างข้อมูล",teacher:"อ.สมชาย"},
      {timeslot:"09:00-10:00",room:"101",subject:"ระบบฐานข้อมูล", teacher:"อ.วิรัตน์"},
    ]
  }
};

// เติม dropdown
const roomSelect = document.getElementById('roomSelect');
buildings.forEach(b => {
  const o=document.createElement('option');
  o.value=b.code;
  o.textContent=`${b.code} - ${b.name}`;
  roomSelect.appendChild(o);
});

document.getElementById('loadBtn').addEventListener('click', ()=>{
  const code=roomSelect.value;
  if(!code){ alert('เลือกอาคารก่อน'); return; }
  const data=mockData[code] || {rooms:[],timeslots:[],entries:[]};
  renderTable(data);
});

function renderTable(data){
  if(!data.rooms.length){
    document.getElementById('tableContainer').innerHTML='<p>ไม่มีข้อมูล</p>';
    return;
  }

  let html='<table><thead><tr><th>เวลา\\ห้อง</th>';
  data.rooms.forEach(r=>html+=`<th>${r}</th>`);
  html+='</tr></thead><tbody>';

  data.timeslots.forEach(ts =>{
    html+=`<tr><th>${ts}</th>`;
    data.rooms.forEach(r=>{
      const e=data.entries.find(x=>x.timeslot===ts && x.room===r);
      html+=e
        ? `<td data-label="เวลา: ${ts}, ห้อง: ${r}">${e.subject}<br><small>${e.teacher}</small></td>`
        : `<td data-label="เวลา: ${ts}, ห้อง: ${r}" class="empty">–</td>`;
    });
    html+='</tr>';
  });

  html+='</tbody></table>';
  document.getElementById('tableContainer').innerHTML=html;
}
</script>

</body>
</html>
